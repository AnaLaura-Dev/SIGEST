<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SIGEST - Documentos</title>
  <link rel="stylesheet" href="/css/documentos.css">
</head>
<body>
  <header>
    <nav>
      <div class="logo">
        <img src="/imagens/logosigest.gif">
      </div>
      <div class="menu">
        <a href="/AreaDoAluno/inicio.html">Início</a>
        <a href="/AreaDoAluno/vagas.html">Vagas</a>
        <a href="/AreaDoAluno/candidaturas.html">Candidaturas</a>
        <a href="/AreaDoAluno/relatorios.html">Relatórios</a>
        <a href="/AreaDoAluno/meudesempenho.html">Meu desempenho</a>
        <a href="/AreaDoAluno/perfil.html">Perfil</a>
      </div>
    </nav>
  </header>

  <h1>Envie seus <span class="verde">documentos</span> para validação do estágio</h1>

   <div class="documentos">
    <a href="/documentos/Modelo de TERMO DE PARA REALIZAÇÃO DE ESTÁGIO.pdf" download="Termo_Compromisso.pdf" class="btn-download">
<i class="fa-solid fa-file" style="color: #353030;"></i> Termo de Compromisso de Estágio (TCE)
    </a>

    <a href="/documentos/MODELO - TERMO DE CIENCIA DO ORIENTADOR.docx.pdf" download="Termo_Ciencia_Orientador.pdf" class="btn-download">
     <i class="fa-solid fa-file" style="color: #353030;"></i> Termo de Ciência do Orientador
    </a>

      <a href="/documentos/_MODELO - Frequência no ESTÁGIO CURRICULAR.docx.pdf" download="Termo_Ciencia_Orientador.pdf" class="btn-download">
     <i class="fa-solid fa-file" style="color: #353030;"></i> Frequência do Estágio
    </a>
  </div>

  <hr>

  <section class="enviar-documentos">
    <h2>Enviar Documentos</h2>
    <form id="formEnvio" enctype="multipart/form-data" class="formEnvio" >
      <label for="nome">Nome completo:</label><br>
      <input type="text" id="nome" name="nome" required><br><br>

      <label for="matricula">Matrícula:</label><br>
      <input type="text" id="matricula" name="matricula" required><br><br>

      <label for="instituicao">Selecione a instituição:</label><br>
      <select name="idInstituicao" id="selectInstituicao" required>
        <option value="">Selecione...</option>
        <option value="1">IFAM CAMPUS MANAUS CENTRO</option>
        <option value="2">IFAM CAMPUS MANAUS ZONA LESTE</option>
        <option value="3">IFAM CAMPUS MANAUS DISTRITO INDUSTRIAL</option>
      </select><br><br>

      <label for="tco">Termo de Ciência do Orientador:</label><br>
      <input type="file" id="tco" name="tco" accept=".pdf,.doc,.docx" required><br><br>

      <label for="tce">Termo de Compromisso de Estágio:</label><br>
      <input type="file" id="tce" name="tce" accept=".pdf,.doc,.docx" required><br><br>

      <button type="submit" class="btn-enviar">Enviar documentos</button>
    </form>
  </section>

  <hr>

  <section id="statusDocumentos">
    <h2>Status dos Documentos</h2>
    <table border="1" cellpadding="8" cellspacing="0">
      <thead>
        <tr>
          <th>Tipo</th>
          <th>Data de Envio</th>
          <th>Arquivo</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody id="tabelaStatus"></tbody>
    </table>
  </section>

  <script>
    // Envio do formulário
    document.getElementById("formEnvio").addEventListener("submit", async (e) => {
      e.preventDefault();
      const formData = new FormData(e.target);
      const resposta = await fetch("/php/enviardocumentos.php", {
        method: "POST",
        body: formData
      });
      const resultado = await resposta.text();
      alert(resultado);
      carregarStatus();
    });

    
  // Carregar status dos documentos
  async function carregarStatus() {
const resp = await fetch("/php/listarDocumentosAlunos.php");
    const dados = await resp.json();

    const tabela = document.getElementById("tabelaStatus");
    tabela.innerHTML = "";

    dados.forEach(doc => {
      let statusHTML = "";

      if (doc.status === "pendente") {
        statusHTML = `<span style="color: orange; font-weight: bold;"> Pendente</span>`;
      }
      else if (doc.status === "validado") {
        statusHTML = `<span style="color: green; font-weight: bold;"> Validado</span>`;
      }
      else if (doc.status === "recusado") {
        statusHTML = `<span style="color: red; font-weight: bold;"> Recusado</span>`;
      }

      const linha = document.createElement("tr");
      linha.innerHTML = `
        <td>${doc.tipoDoc}</td>
        <td>${doc.dataEnvio}</td>
        <td><a href="${doc.arquivo}" target="_blank">Abrir</a></td>
        <td>${statusHTML}</td>
      `;
      tabela.appendChild(linha);
    });
  }

  carregarStatus();
  </script>
</body>
</html>
